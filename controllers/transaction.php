<?phpclass Transaction extends Controller{    function index(){}				function get_transaction(){		$ord_id=user_in_filter($_POST['id']);		$this->loadModel('transactions');		$txn=new Transactions();		$data=$txn->get_transaction($ord_id);		if(empty($data)){			echo "Payment not initiated";		}else{			echo "<table><tr><th width='150' style='text-align:center'>Date time</th><th width='150' style='text-align:center'>Status</th><th width='250' style='text-align:center'>Details</th></tr>";			$refund=FALSE;			foreach($data as $value){				$notes='';				if(!empty($value['notes'])){					$note=json_decode($value['notes']);					foreach($note as $key=>$val){						if($key=='amount'){ $key=$key." paid"; $val=$val;}						$notes.=$key." : ".$val."<br>";					}					}				echo "<tr><td>".gmdate("Y-m-d H:i:s",$value['timestamp'])."</td><td>".$value['status']."</td><td>".$notes."</td></tr>";			}			echo "</table>";		}					}			    function view_transactions(){        $this->loadModel('transactions');        $om=new Transactions();        $draw=user_in_filter($_REQUEST['draw']);        $start=user_in_filter($_REQUEST['start']);        $length=user_in_filter($_REQUEST['length']);        $search=user_in_filter($_REQUEST['search']['value']);        $orderby=  user_in_filter($_REQUEST['order'][0]['column']);        $orderval=  user_in_filter($_REQUEST['order'][0]['dir']);        $count=$om->total_transactions();        $transaction_list=$om->list_transactions($start,$length,$orderby,$orderval,$search);        $data['draw']=$draw;        $data['recordsTotal']=$count;        $data['recordsFiltered']=$count;        $n=0;        if(!$transaction_list){            $data['sEcho']=0;        }        foreach ($transaction_list as $value) {                        $notes=(array)json_decode($value['notes']);            $details="";            foreach ($notes as $key=>$det) {                if($key=='amount'){ $key=$key." paid"; $det=$det/100;}                $details.=$key.": ".$det."<br>";            }            $data['data'][$n][0]=$n+1;            $data['data'][$n][1]=gmdate("Y-m-d H:i:s",$value['timestamp']);            $data['data'][$n][2]=$value['phone'];            $data['data'][$n][3]=$value['status'];            $data['data'][$n][4]= $details;            if($value['status']!='completed'){ $class="btn btn-default hidden";}  else {$class="btn btn-default";}            $data['data'][$n][5]="<button  class='$class' onclick='refund(\"".$value['stripid']."\")'>Refund</button>";                                    $n++;        }        echo json_encode($data);    }          //end of class    }